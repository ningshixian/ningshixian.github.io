

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="NSX">
  <meta name="keywords" content="">
  
    <meta name="description" content="K-means ç®—æ³•æ˜¯ä¸€ç§åŸºäºç›¸ä¼¼å±æ€§å°†ä¸€ç»„æ•°æ®ç‚¹åˆ’åˆ†ä¸ºä¸åŒé›†ç¾¤æˆ–ç»„çš„æ–¹æ³•ã€‚å®ƒæ˜¯ä¸€ç§æ— ç›‘ç£å­¦ä¹ ç®—æ³•ï¼Œè¿™æ„å‘³ç€å®ƒä¸éœ€è¦æ ‡è®°æ•°æ®æ¥æŸ¥æ‰¾æ•°æ®é›†ä¸­çš„æ¨¡å¼ã€‚  K-Meansä½¿ç”¨æ­¥éª¤ åˆå§‹ä¸­å¿ƒç‚¹æ€ä¹ˆç¡®å®š Kå€¼æ€ä¹ˆç¡®å®š ã€ŒKå‡å€¼èšç±»ã€çš„Tips  ä»€ä¹ˆæ˜¯èšç±»ï¼Ÿèšç±»çš„ç›®æ ‡æ˜¯å°†é¡¹ç›®åˆ†æˆç»„ï¼Œä½¿å¾—ç»„ä¸­çš„å¯¹è±¡æ¯”ç»„å¤–çš„å¯¹è±¡æ›´ç›¸ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ k-means ä¸­ä½¿ç”¨æˆ‘ä»¬æƒ³è¦çš„ä»»ä½•ç›¸ä¼¼åº¦å‡½æ•°æ¥æ¯”è¾ƒä¸¤ä¸ªç‚¹ã€‚ å¦‚ä½•å®šä¹‰é›†ç¾¤ä¸­çš„ç›¸">
<meta property="og:type" content="article">
<meta property="og:title" content="K-meansèšç±»è¯¦è§£">
<meta property="og:url" content="http://example.com/2021/09/06/2021-09-06-K-means%E8%81%9A%E7%B1%BB%E8%AF%A6%E8%A7%A3/index.html">
<meta property="og:site_name" content="ç¥çš„ä¸ªäººåšå®¢">
<meta property="og:description" content="K-means ç®—æ³•æ˜¯ä¸€ç§åŸºäºç›¸ä¼¼å±æ€§å°†ä¸€ç»„æ•°æ®ç‚¹åˆ’åˆ†ä¸ºä¸åŒé›†ç¾¤æˆ–ç»„çš„æ–¹æ³•ã€‚å®ƒæ˜¯ä¸€ç§æ— ç›‘ç£å­¦ä¹ ç®—æ³•ï¼Œè¿™æ„å‘³ç€å®ƒä¸éœ€è¦æ ‡è®°æ•°æ®æ¥æŸ¥æ‰¾æ•°æ®é›†ä¸­çš„æ¨¡å¼ã€‚  K-Meansä½¿ç”¨æ­¥éª¤ åˆå§‹ä¸­å¿ƒç‚¹æ€ä¹ˆç¡®å®š Kå€¼æ€ä¹ˆç¡®å®š ã€ŒKå‡å€¼èšç±»ã€çš„Tips  ä»€ä¹ˆæ˜¯èšç±»ï¼Ÿèšç±»çš„ç›®æ ‡æ˜¯å°†é¡¹ç›®åˆ†æˆç»„ï¼Œä½¿å¾—ç»„ä¸­çš„å¯¹è±¡æ¯”ç»„å¤–çš„å¯¹è±¡æ›´ç›¸ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ k-means ä¸­ä½¿ç”¨æˆ‘ä»¬æƒ³è¦çš„ä»»ä½•ç›¸ä¼¼åº¦å‡½æ•°æ¥æ¯”è¾ƒä¸¤ä¸ªç‚¹ã€‚ å¦‚ä½•å®šä¹‰é›†ç¾¤ä¸­çš„ç›¸">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i1.wp.com/analyticsarora.com/wp-content/uploads/2021/07/euclidean-distance-between-two-points-in-x-y-coordinates.png?resize=800%2C600&amp;ssl=1#id=QEtTm&amp;originHeight=600&amp;originWidth=800&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=">
<meta property="og:image" content="https://i2.wp.com/analyticsarora.com/wp-content/uploads/2021/07/manhattan-distance-between-two-points-in-x-y-coordinates.png?resize=800%2C600&amp;ssl=1#id=iLrws&amp;originHeight=600&amp;originWidth=800&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=">
<meta property="og:image" content="https://i0.wp.com/analyticsarora.com/wp-content/uploads/2021/07/partitional-clustering-example-of-a-set-of-data-points.png?resize=800%2C600&amp;ssl=1#id=ne7yX&amp;originHeight=600&amp;originWidth=800&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=">
<meta property="og:image" content="https://i1.wp.com/analyticsarora.com/wp-content/uploads/2021/07/Hierarchical-Clustering-example-with-resulting-dendrogram.png?resize=800%2C600&amp;ssl=1#id=W7uHq&amp;originHeight=600&amp;originWidth=800&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=">
<meta property="og:image" content="https://i2.wp.com/analyticsarora.com/wp-content/uploads/2021/07/K-Means-Pseudocode.png?resize=800%2C300&amp;ssl=1#id=jFfSp&amp;originHeight=300&amp;originWidth=800&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=">
<meta property="og:image" content="https://i1.wp.com/analyticsarora.com/wp-content/uploads/2021/07/elbow-method-example-choosing-number-of-clusters-k-means.png?resize=464%2C299&amp;ssl=1#id=JyGLl&amp;originHeight=299&amp;originWidth=464&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=">
<meta property="article:published_time" content="2021-09-05T16:00:00.000Z">
<meta property="article:modified_time" content="2023-04-24T10:31:59.922Z">
<meta property="article:author" content="Ning Shixian">
<meta property="article:tag" content="æ–‡æœ¬èšç±»">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://i1.wp.com/analyticsarora.com/wp-content/uploads/2021/07/euclidean-distance-between-two-points-in-x-y-coordinates.png?resize=800%2C600&amp;ssl=1#id=QEtTm&amp;originHeight=600&amp;originWidth=800&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=">
  
  
  
  <title>K-meansèšç±»è¯¦è§£ - ç¥çš„ä¸ªäººåšå®¢</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>ç¥çš„ä¸ªäººåšå®¢</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>é¦–é¡µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>å½’æ¡£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>åˆ†ç±»</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>æ ‡ç­¾</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>å…³äº</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="K-meansèšç±»è¯¦è§£"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2021-09-06 00:00" pubdate>
          2021å¹´9æœˆ6æ—¥ å‡Œæ™¨
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          14k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          114 åˆ†é’Ÿ
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">K-meansèšç±»è¯¦è§£</h1>
            
            
              <div class="markdown-body">
                
                <p>K-means ç®—æ³•æ˜¯ä¸€ç§åŸºäºç›¸ä¼¼å±æ€§å°†ä¸€ç»„æ•°æ®ç‚¹åˆ’åˆ†ä¸ºä¸åŒé›†ç¾¤æˆ–ç»„çš„æ–¹æ³•ã€‚å®ƒæ˜¯ä¸€ç§æ— ç›‘ç£å­¦ä¹ ç®—æ³•ï¼Œè¿™æ„å‘³ç€å®ƒä¸éœ€è¦æ ‡è®°æ•°æ®æ¥æŸ¥æ‰¾æ•°æ®é›†ä¸­çš„æ¨¡å¼ã€‚</p>
<ul>
<li>K-Meansä½¿ç”¨æ­¥éª¤</li>
<li>åˆå§‹ä¸­å¿ƒç‚¹æ€ä¹ˆç¡®å®š</li>
<li>Kå€¼æ€ä¹ˆç¡®å®š</li>
<li>ã€ŒKå‡å€¼èšç±»ã€çš„Tips</li>
</ul>
<h2 id="ä»€ä¹ˆæ˜¯èšç±»ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯èšç±»ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯èšç±»ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯èšç±»ï¼Ÿ</h2><p>èšç±»çš„ç›®æ ‡æ˜¯å°†é¡¹ç›®åˆ†æˆç»„ï¼Œä½¿å¾—ç»„ä¸­çš„å¯¹è±¡æ¯”ç»„å¤–çš„å¯¹è±¡æ›´ç›¸ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ k-means ä¸­ä½¿ç”¨æˆ‘ä»¬æƒ³è¦çš„ä»»ä½•ç›¸ä¼¼åº¦å‡½æ•°æ¥æ¯”è¾ƒä¸¤ä¸ªç‚¹ã€‚</p>
<h3 id="å¦‚ä½•å®šä¹‰é›†ç¾¤ä¸­çš„ç›¸ä¼¼æ€§ï¼Ÿ"><a href="#å¦‚ä½•å®šä¹‰é›†ç¾¤ä¸­çš„ç›¸ä¼¼æ€§ï¼Ÿ" class="headerlink" title="å¦‚ä½•å®šä¹‰é›†ç¾¤ä¸­çš„ç›¸ä¼¼æ€§ï¼Ÿ"></a>å¦‚ä½•å®šä¹‰é›†ç¾¤ä¸­çš„ç›¸ä¼¼æ€§ï¼Ÿ</h3><p>æ¯”è¾ƒä¸¤ä¸ªæ•°æ®ç‚¹ç›¸ä¼¼æ€§çš„æœ€å¸¸è§å’Œæœ€ç›´æ¥çš„æ–¹æ³•æ˜¯ä½¿ç”¨è·ç¦»ã€‚ä¸ä½¿ç”¨å‹¾è‚¡å®šç†æ±‚å¯¹è§’çº¿é•¿åº¦çš„æ–¹å¼ç›¸åŒï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—ä¸¤ä¸ªæ•°æ®ç‚¹ä¹‹é—´çš„è·ç¦»ã€‚</p>
<p><img src="https://i1.wp.com/analyticsarora.com/wp-content/uploads/2021/07/euclidean-distance-between-two-points-in-x-y-coordinates.png?resize=800%2C600&amp;ssl=1#id=QEtTm&amp;originHeight=600&amp;originWidth=800&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" srcset="/img/loading.gif" lazyload alt=""></p>
<p>è¿™ç§æ¯”è¾ƒç›¸ä¼¼åº¦çš„æ–¹æ³•ç§°ä¸º<strong>æ¬§å‡ é‡Œå¾—è·ç¦»</strong>ã€‚K-means èšç±»ä¸­å¦ä¸€ä¸ªå¸¸ç”¨çš„ç›¸ä¼¼åº¦å‡½æ•°ç§°ä¸º<strong>æ›¼å“ˆé¡¿è·ç¦»</strong>ã€‚</p>
<p><img src="https://i2.wp.com/analyticsarora.com/wp-content/uploads/2021/07/manhattan-distance-between-two-points-in-x-y-coordinates.png?resize=800%2C600&amp;ssl=1#id=iLrws&amp;originHeight=600&amp;originWidth=800&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" srcset="/img/loading.gif" lazyload alt=""></p>
<p>è¿™ä¸¤ä¸ªè·ç¦»å…¬å¼å¯¹ç”¨äºèšç±»ä»»åŠ¡çš„å„ç§æ•°æ®é›†éƒ½å¾ˆæœ‰æ•ˆã€‚ç„¶è€Œï¼Œç»™å®šçš„ç›¸ä¼¼åº¦å‡½æ•°å¯èƒ½å¹¶éå¯¹æ•°æ®ç‚¹çš„æ¯ä¸ªåˆ†å¸ƒéƒ½æœ‰æ•ˆã€‚è¿™å°±æå‡ºäº†ä¸€ä¸ªé—®é¢˜ï¼Œâ€œä¸€ä¸ªå¥½çš„ç›¸ä¼¼åº¦å‡½æ•°çš„ç‰¹æ€§æ˜¯ä»€ä¹ˆï¼Ÿâ€ã€‚</p>
<h3 id="è‰¯å¥½ç›¸ä¼¼å‡½æ•°çš„ç‰¹å¾"><a href="#è‰¯å¥½ç›¸ä¼¼å‡½æ•°çš„ç‰¹å¾" class="headerlink" title="è‰¯å¥½ç›¸ä¼¼å‡½æ•°çš„ç‰¹å¾"></a>è‰¯å¥½ç›¸ä¼¼å‡½æ•°çš„ç‰¹å¾</h3><p>å¯ä»¥ä½¿ç”¨ä¸‰ä¸ªåŸºæœ¬å±æ€§æ¥è¯„ä¼°ç›¸ä¼¼åº¦å‡½æ•°æ˜¯å¦è‰¯å¥½ã€‚å½“ç„¶ï¼Œè¿˜æœ‰æ›´å¤šçš„æ ‡å‡†å¯ä»¥è€ƒè™‘ï¼Œä½†è¿™äº›æ˜¯æœ€é‡è¦çš„ã€‚åœ¨ç¬¦å·ä¸‹æ–¹d(x,y)_d_ ( _x_ ,_å’Œ_) è¯»ä½œâ€œx å’Œ y ä¹‹é—´çš„è·ç¦»â€ã€‚</p>
<p><strong>å¯¹ç§°æ€§</strong>ï¼š $d(x,y) = d(y,x)$</p>
<p>å¯¹ç§°æ€§å¾ˆé‡è¦ï¼Œå¦åˆ™æˆ‘ä»¬å¯ä»¥è¯´ A çœ‹èµ·æ¥åƒ Bï¼Œä½† B çœ‹èµ·æ¥ä¸€ç‚¹ä¹Ÿä¸åƒ Aã€‚</p>
<p><strong>æ­£å¯åˆ†ç¦»æ€§</strong>ï¼š$d(x,y) = 0 \quad if \quad and \quad only \quad if \quad x=y$</p>
<p>æ­£å¯åˆ†æ€§çš„å±æ€§å¾ˆé‡è¦ï¼Œå› ä¸ºå¦åˆ™å¯èƒ½ä¼šæœ‰ä¸¤ä¸ªä¸åŒçš„æ•°æ®ç‚¹ A å’Œ Bï¼Œæˆ‘ä»¬æ— æ³•åŒºåˆ†ã€‚</p>
<p><strong>ä¸‰è§’ä¸ç­‰å¼</strong>ï¼š$d(x,y) \leq d(x,z) + d(z,y)$</p>
<p>ä¸‰è§’ä¸ç­‰å¼å¾ˆé‡è¦ï¼Œå¦åˆ™æˆ‘ä»¬å¯ä»¥è¯´ A çœ‹èµ·æ¥åƒ Bï¼ŒB çœ‹èµ·æ¥åƒ Cï¼Œä½† A çœ‹èµ·æ¥ä¸åƒ Cã€‚</p>
<h3 id="å¸¸ç”¨èšç±»æ–¹æ³•æ¦‚è¿°"><a href="#å¸¸ç”¨èšç±»æ–¹æ³•æ¦‚è¿°" class="headerlink" title="å¸¸ç”¨èšç±»æ–¹æ³•æ¦‚è¿°"></a>å¸¸ç”¨èšç±»æ–¹æ³•æ¦‚è¿°</h3><p>æœ¬æ–‡é‡ç‚¹ä»‹ç» K å‡å€¼èšç±»ï¼Œä½†è¿™åªæ˜¯ç°æœ‰çš„ä¼—å¤šèšç±»ç®—æ³•ä¹‹ä¸€ã€‚</p>
<h4 id="1-åˆ†åŒºèšç±»"><a href="#1-åˆ†åŒºèšç±»" class="headerlink" title="1.åˆ†åŒºèšç±»"></a>1.åˆ†åŒºèšç±»</h4><p>K-means æ˜¯<strong>åˆ†åŒºèšç±»ç®—æ³•</strong>ï¼ˆä¹Ÿç§°ä¸º<strong>åŸºäºè´¨å¿ƒçš„èšç±»</strong>ï¼‰çš„ä¸€ä¸ªä¾‹å­ã€‚è¿™æ„å‘³ç€å®ƒæ¥å—ç”¨æˆ·æä¾›çš„é›†ç¾¤æ•°é‡_k_ï¼Œå¹¶å°†æ•°æ®åˆ’åˆ†ä¸ºè®¸å¤šåˆ†åŒºã€‚åœ¨åˆ†åŒºèšç±»ä¸­ï¼Œæ¯ä¸ªæ•°æ®ç‚¹åªèƒ½å±äºä¸€ä¸ªé›†ç¾¤ï¼Œä»»ä½•é›†ç¾¤éƒ½ä¸èƒ½ä¸ºç©ºã€‚</p>
<p>è®¸å¤šåˆ†åŒºèšç±»ç®—æ³•<strong>æ˜¯éç¡®å®šæ€§çš„</strong>ã€‚è¿™æ„å‘³ç€ï¼Œå³ä½¿æ‚¨ä¿æŒè¾“å…¥å›ºå®šï¼Œæ¯æ¬¡è¿è¡Œç®—æ³•æ—¶ä¹Ÿå¯èƒ½æœ€ç»ˆå¾—åˆ°ä¸åŒçš„é›†ç¾¤ã€‚</p>
<p><img src="https://i0.wp.com/analyticsarora.com/wp-content/uploads/2021/07/partitional-clustering-example-of-a-set-of-data-points.png?resize=800%2C600&amp;ssl=1#id=ne7yX&amp;originHeight=600&amp;originWidth=800&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" srcset="/img/loading.gif" lazyload alt=""></p>
<h4 id="2-å±‚æ¬¡èšç±»"><a href="#2-å±‚æ¬¡èšç±»" class="headerlink" title="2.å±‚æ¬¡èšç±»"></a>2.<strong>å±‚æ¬¡èšç±»</strong></h4><p><strong>å±‚æ¬¡èšç±»</strong>ä¸‹çš„ç®—æ³•é€šè¿‡<strong>è‡ªä¸Šè€Œä¸‹</strong>æˆ–<strong>è‡ªä¸‹è€Œä¸Š</strong>æ„å»º<strong>å±‚æ¬¡ç»“æ„æ¥</strong>å°†å¯¹è±¡åˆ†é…ç»™é›†ç¾¤ã€‚</p>
<ul>
<li>è‡ªé¡¶å‘ä¸‹çš„æ–¹æ³•ç§°ä¸º<strong>åˆ†è£‚èšç±»</strong>ã€‚å®ƒçš„å·¥ä½œåŸç†æ˜¯ä»ä¸€ä¸ªé›†ç¾¤ä¸­çš„æ‰€æœ‰ç‚¹å¼€å§‹ï¼Œç„¶ååœ¨æ¯ä¸€æ­¥æ‹†åˆ†æœ€ä¸ç›¸ä¼¼çš„é›†ç¾¤ï¼Œç›´åˆ°æ¯ä¸ªæ•°æ®ç‚¹éƒ½åœ¨ä¸€ä¸ªå•ç‹¬çš„é›†ç¾¤ä¸­ã€‚ </li>
<li>è‡ªåº•å‘ä¸Šçš„æ–¹æ³•ç§°ä¸º<strong>å‡èšèšç±»</strong>ã€‚è¿™ç§æ–¹æ³•è¿­ä»£åœ°åˆå¹¶é›†ç¾¤ä¸­ä¸¤ä¸ªæœ€ç›¸ä¼¼çš„ç‚¹ï¼Œç›´åˆ°åªæœ‰ä¸€ä¸ªå¤§é›†ç¾¤ã€‚ </li>
</ul>
<p>ä¸åˆ†åŒºèšç±»æ–¹æ³•ä¸åŒï¼Œå±‚æ¬¡èšç±»æ˜¯<strong>ç¡®å®šæ€§çš„</strong>ã€‚è¿™æ„å‘³ç€é›†ç¾¤åˆ†é…åœ¨åŒä¸€æ•°æ®é›†ä¸Šçš„è¿è¡Œä¹‹é—´ä¸ä¼šæœ‰æ‰€ä¸åŒã€‚</p>
<p>è‡ªä¸Šè€Œä¸‹å’Œè‡ªä¸‹è€Œä¸Šçš„æ–¹æ³•éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªåŸºäºæ ‘çš„ç‚¹å±‚æ¬¡ç»“æ„ï¼Œç§°ä¸º <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Dendrogram"><strong>dendrogram</strong></a>ã€‚äº‹å®è¯æ˜ï¼Œæ­¤æ ‘çŠ¶å›¾å¯ç”¨äºé€‰æ‹©è¦ä½¿ç”¨çš„é›†ç¾¤æ•°é‡ã€‚æ‚¨å¯ä»¥åœ¨ä»»ä½•æ·±åº¦åˆ‡å‰²æ ‘ä»¥ç”Ÿæˆä¸ç›¸äº¤æ ‘çš„å­é›†ï¼Œæ¯ä¸ªæ ‘ä»£è¡¨ä¸€ä¸ªé›†ç¾¤ã€‚</p>
<p><img src="https://i1.wp.com/analyticsarora.com/wp-content/uploads/2021/07/Hierarchical-Clustering-example-with-resulting-dendrogram.png?resize=800%2C600&amp;ssl=1#id=W7uHq&amp;originHeight=600&amp;originWidth=800&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" srcset="/img/loading.gif" lazyload alt=""></p>
<h4 id="æ¯”è¾ƒåˆ†åŒºèšç±»å’Œå±‚æ¬¡èšç±»"><a href="#æ¯”è¾ƒåˆ†åŒºèšç±»å’Œå±‚æ¬¡èšç±»" class="headerlink" title="æ¯”è¾ƒåˆ†åŒºèšç±»å’Œå±‚æ¬¡èšç±»"></a><strong>æ¯”è¾ƒåˆ†åŒºèšç±»å’Œå±‚æ¬¡èšç±»</strong></h4><p>ä¸¤ç§èšç±»æ–¹æ³•å„æœ‰ä¼˜ç¼ºç‚¹ã€‚é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹ä½¿ç”¨K-meansï¼ˆpartitional clusteringï¼‰çš„ä¼˜ç¼ºç‚¹ã€‚</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>K-means çš„ä¼˜ç‚¹</th>
<th>K-means çš„ç¼ºç‚¹</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ˜“äºå®æ–½</td>
<td>éš¾ä»¥é¢„æµ‹èšç±»çš„æ•°é‡ï¼ˆK-Valueï¼‰</td>
</tr>
<tr>
<td>k-Means å¯èƒ½æ¯”å…·æœ‰å¤§é‡å˜é‡çš„å±‚æ¬¡èšç±»æ›´å¿«ï¼ˆå¦‚æœ K å¾ˆå°ï¼‰</td>
<td>åˆå§‹ç§å­å¯¹æœ€ç»ˆç»“æœæœ‰å¾ˆå¤§å½±å“</td>
</tr>
<tr>
<td>k-Means å¯èƒ½äº§ç”Ÿæ¯”å±‚æ¬¡èšç±»æ›´ç´§å¯†çš„èšç±»</td>
<td>æ•°æ®çš„é¡ºåºå¯¹æœ€ç»ˆç»“æœæœ‰å½±å“</td>
</tr>
<tr>
<td>é‡æ–°è®¡ç®—è´¨å¿ƒæ—¶ï¼Œå®ä¾‹å¯ä»¥æ›´æ”¹é›†ç¾¤ï¼ˆç§»åŠ¨åˆ°å¦ä¸€ä¸ªé›†ç¾¤ï¼‰</td>
<td>å¯¹ç¼©æ”¾æ•æ„Ÿï¼šé‡æ–°ç¼©æ”¾æ•°æ®é›†ï¼ˆæ ‡å‡†åŒ–æˆ–æ ‡å‡†åŒ–ï¼‰å°† å®Œå…¨æ”¹å˜ç»“æœã€‚</td>
</tr>
</tbody>
</table>
</div>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹å±‚æ¬¡èšç±»çš„ä¼˜ç‚¹å’Œç¼ºç‚¹ã€‚</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>å±‚æ¬¡èšç±»çš„ä¼˜ç‚¹</th>
<th>å±‚æ¬¡èšç±»çš„ç¼ºç‚¹</th>
</tr>
</thead>
<tbody>
<tr>
<td>è¾“å‡ºæ¯” k-means è¿”å›çš„éç»“æ„åŒ–é›†ç¾¤é›†ä¿¡æ¯æ›´å¤šçš„å±‚æ¬¡ç»“æ„ã€‚</td>
<td>ä¸€æ—¦ä¸€ä¸ªç‚¹è¢«åˆ†é…ç»™ä¸€ä¸ª é›†ç¾¤ï¼Œå®ƒå°±ä¸èƒ½å†å››å¤„ç§»åŠ¨äº†ã€‚</td>
</tr>
<tr>
<td>æ˜“äºå®æ–½</td>
<td>æ—¶é—´å¤æ‚åº¦ï¼šä¸é€‚åˆå¤§æ•°æ®é›†</td>
</tr>
<tr>
<td></td>
<td>åˆå§‹ç§å­å¯¹æœ€ç»ˆç»“æœæœ‰å¾ˆå¤§å½±å“</td>
</tr>
<tr>
<td></td>
<td>æ•°æ®çš„é¡ºåºå¯¹æœ€ç»ˆç»“æœæœ‰å½±å“</td>
</tr>
</tbody>
</table>
</div>
<p>æˆ‘å·²ç»æ¦‚è¿°äº†ä¸¤ä¸ªèšç±»ç®—æ³•ç³»åˆ—ã€‚è¿˜æœ‰å…¶ä»–ç±»å‹çš„èšç±»ç®—æ³•æˆ‘æ²¡æœ‰ä»‹ç»ï¼Œä¾‹å¦‚<strong>åŸºäºå¯†åº¦çš„èšç±»</strong>ã€‚æœ‰å…³èšç±»ç®—æ³•çš„æ›´å®Œæ•´æ¦‚è¿°ï¼Œè¯·è®¿é—®<a target="_blank" rel="noopener" href="https://developers.google.com/machine-learning/clustering/clustering-algorithms">æ­¤èµ„æº</a>ã€‚</p>
<h2 id="K-means-Clustering-å¦‚ä½•åœ¨è§†è§‰ä¸Šå·¥ä½œï¼Ÿ"><a href="#K-means-Clustering-å¦‚ä½•åœ¨è§†è§‰ä¸Šå·¥ä½œï¼Ÿ" class="headerlink" title="K-means Clustering å¦‚ä½•åœ¨è§†è§‰ä¸Šå·¥ä½œï¼Ÿ"></a><strong>K-means Clustering å¦‚ä½•åœ¨è§†è§‰ä¸Šå·¥ä½œï¼Ÿ</strong></h2><p>æ­¤å¯è§†åŒ–æ˜¾ç¤ºäº†ä½¿ç”¨ 3 ä¸ªé›†ç¾¤è¿è¡Œçš„ k-means ç®—æ³•ã€‚é¦–å…ˆï¼Œåˆå§‹åŒ–ä¸‰ä¸ª<strong>è´¨å¿ƒ</strong>ã€‚è¿™äº›æ˜¯æ¯ä¸ªé›†ç¾¤çš„åˆå§‹ä¸­å¿ƒï¼Œç”±è“è‰²ã€çº¢è‰²å’Œç»¿è‰²å¤§ç‚¹è¡¨ç¤ºã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œè®¡ç®—ç»™å®šæ•°æ®ç‚¹ä¸ä¸‰ä¸ªè´¨å¿ƒä¸­çš„æ¯ä¸€ä¸ªä¹‹é—´çš„è·ç¦»ã€‚è¿™æ˜¯é’ˆå¯¹æ‰€æœ‰æ•°æ®ç‚¹å®Œæˆçš„ã€‚æ¯ä¸ªç‚¹éƒ½åˆ†é…ç»™å®ƒæœ€æ¥è¿‘çš„è´¨å¿ƒçš„é›†ç¾¤ã€‚å½“æˆ‘åœ¨å¯è§†åŒ–ä¸­å•å‡»<strong>é‡æ–°åˆ†é…ç‚¹</strong>æ—¶ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚</p>
<p>ç„¶åï¼Œé€šè¿‡å¯¹ç›¸åº”é›†ç¾¤ä¸­æ¯ä¸ªæ•°æ®ç‚¹çš„åæ ‡æ±‚å¹³å‡å€¼æ¥é‡æ–°è®¡ç®—è´¨å¿ƒã€‚å½“æˆ‘å•å‡»<strong>Update Centroids</strong>æ—¶ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚</p>
<p>è¿™ä¸ªé‡æ–°åˆ†é…ç‚¹å’Œæ›´æ–°è´¨å¿ƒçš„è¿‡ç¨‹ä¸€ç›´æŒç»­åˆ°è´¨å¿ƒä¸å†ç§»åŠ¨ã€‚</p>
<p>æ‚¨å¯ä»¥ä½¿ç”¨æ­¤å¯è§†åŒ–è‡ªå·±ç›´è§‚åœ°äº†è§£ k-meansï¼<a target="_blank" rel="noopener" href="https://www.naftaliharris.com/blog/visualizing-k-means-clustering/">åœ¨è¿™é‡Œ</a>è¯•è¯•ã€‚</p>
<h2 id="K-Meansä¼ªä»£ç "><a href="#K-Meansä¼ªä»£ç " class="headerlink" title="K-Meansä¼ªä»£ç "></a>K-Meansä¼ªä»£ç </h2><p>K-Meansèšç±»æ­¥éª¤æ˜¯ä¸€ä¸ªå¾ªç¯è¿­ä»£çš„ç®—æ³•ï¼Œéå¸¸ç®€å•æ˜“æ‡‚ï¼š</p>
<ol>
<li>å‡å®šæˆ‘ä»¬è¦å¯¹Nä¸ªæ ·æœ¬è§‚æµ‹åšèšç±»ï¼Œè¦æ±‚èšä¸ºKç±»ï¼Œé¦–å…ˆé€‰æ‹©Kä¸ªç‚¹ä½œä¸º<code>åˆå§‹ä¸­å¿ƒç‚¹</code>ï¼›</li>
<li>æ¥ä¸‹æ¥ï¼ŒæŒ‰ç…§<code>è·ç¦»åˆå§‹ä¸­å¿ƒç‚¹æœ€å°</code>çš„åŸåˆ™ï¼ŒæŠŠæ‰€æœ‰è§‚æµ‹åˆ†åˆ°å„ä¸­å¿ƒç‚¹æ‰€åœ¨çš„ç±»ä¸­ï¼›</li>
<li>æ¯ç±»ä¸­æœ‰è‹¥å¹²ä¸ªè§‚æµ‹ï¼Œè®¡ç®—Kä¸ªç±»ä¸­<code>æ‰€æœ‰æ ·æœ¬ç‚¹çš„å‡å€¼</code>ï¼Œä½œä¸ºç¬¬äºŒæ¬¡è¿­ä»£çš„Kä¸ªä¸­å¿ƒç‚¹ï¼›</li>
<li>ç„¶åæ ¹æ®è¿™ä¸ªä¸­å¿ƒé‡å¤ç¬¬2ã€3æ­¥ï¼Œç›´åˆ°<code>æ”¶æ•›ï¼ˆä¸­å¿ƒç‚¹ä¸å†æ”¹å˜æˆ–è¾¾åˆ°æŒ‡å®šçš„è¿­ä»£æ¬¡æ•°ï¼‰</code>ï¼Œèšç±»è¿‡ç¨‹ç»“æŸã€‚</li>
</ol>
<p><img src="https://i2.wp.com/analyticsarora.com/wp-content/uploads/2021/07/K-Means-Pseudocode.png?resize=800%2C300&amp;ssl=1#id=jFfSp&amp;originHeight=300&amp;originWidth=800&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" srcset="/img/loading.gif" lazyload alt=""></p>
<h2 id="â­ï¸ä½¿ç”¨-sklearn-ä¸­çš„-K-Means"><a href="#â­ï¸ä½¿ç”¨-sklearn-ä¸­çš„-K-Means" class="headerlink" title="â­ï¸ä½¿ç”¨ sklearn ä¸­çš„ K-Means"></a>â­ï¸ä½¿ç”¨ sklearn ä¸­çš„ K-Means</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/ljpzzz/machinelearning/blob/master/classic-machine-learning/kmeans_cluster.ipynb">https://github.com/ljpzzz/machinelearning/blob/master/classic-machine-learning/kmeans_cluster.ipynb</a></p>
</blockquote>
<p>KMeansç±»çš„ä¸»è¦å‚æ•°æœ‰ï¼š</p>
<ol>
<li>n_clusters: å³æˆ‘ä»¬çš„kå€¼ï¼Œä¸€èˆ¬éœ€è¦å¤šè¯•ä¸€äº›å€¼ä»¥è·å¾—è¾ƒå¥½çš„èšç±»æ•ˆæœã€‚kå€¼å¥½åçš„è¯„ä¼°æ ‡å‡†åœ¨ä¸‹é¢ä¼šè®²ã€‚</li>
<li>max_iterï¼š æœ€å¤§çš„è¿­ä»£æ¬¡æ•°ï¼Œä¸€èˆ¬å¦‚æœæ˜¯å‡¸æ•°æ®é›†çš„è¯å¯ä»¥ä¸ç®¡è¿™ä¸ªå€¼ï¼Œå¦‚æœæ•°æ®é›†ä¸æ˜¯å‡¸çš„ï¼Œå¯èƒ½å¾ˆéš¾æ”¶æ•›ï¼Œæ­¤æ—¶å¯ä»¥æŒ‡å®šæœ€å¤§çš„è¿­ä»£æ¬¡æ•°è®©ç®—æ³•å¯ä»¥åŠæ—¶é€€å‡ºå¾ªç¯ã€‚</li>
<li>n_initï¼šç”¨ä¸åŒçš„åˆå§‹åŒ–è´¨å¿ƒè¿è¡Œç®—æ³•çš„æ¬¡æ•°ã€‚ç”±äºK-Meansæ˜¯ç»“æœå—åˆå§‹å€¼å½±å“çš„å±€éƒ¨æœ€ä¼˜çš„è¿­ä»£ç®—æ³•ï¼Œå› æ­¤éœ€è¦å¤šè·‘å‡ æ¬¡ä»¥é€‰æ‹©ä¸€ä¸ªè¾ƒå¥½çš„èšç±»æ•ˆæœï¼Œé»˜è®¤æ˜¯10ï¼Œä¸€èˆ¬ä¸éœ€è¦æ”¹ã€‚å¦‚æœä½ çš„kå€¼è¾ƒå¤§ï¼Œåˆ™å¯ä»¥é€‚å½“å¢å¤§è¿™ä¸ªå€¼ã€‚</li>
<li>initï¼š å³åˆå§‹å€¼é€‰æ‹©çš„æ–¹å¼ï¼Œå¯ä»¥ä¸ºå®Œå…¨éšæœºé€‰æ‹©â€™randomâ€™,ä¼˜åŒ–è¿‡çš„â€™k-means++â€™æˆ–è€…è‡ªå·±æŒ‡å®šåˆå§‹åŒ–çš„kä¸ªè´¨å¿ƒã€‚ä¸€èˆ¬å»ºè®®ä½¿ç”¨é»˜è®¤çš„â€™k-means++â€™ã€‚</li>
<li>algorithmï¼šæœ‰â€œautoâ€, â€œfullâ€ or â€œelkanâ€ä¸‰ç§é€‰æ‹©ã€‚â€fullâ€å°±æ˜¯æˆ‘ä»¬ä¼ ç»Ÿçš„K-Meansç®—æ³•ï¼Œ â€œelkanâ€æ˜¯æˆ‘ä»¬åŸç†ç¯‡è®²çš„elkan K-Meansç®—æ³•ã€‚é»˜è®¤çš„â€autoâ€åˆ™ä¼šæ ¹æ®æ•°æ®å€¼æ˜¯å¦æ˜¯ç¨€ç–çš„ï¼Œæ¥å†³å®šå¦‚ä½•é€‰æ‹©â€fullâ€å’Œâ€œelkanâ€ã€‚ä¸€èˆ¬æ•°æ®æ˜¯ç¨ å¯†çš„ï¼Œé‚£ä¹ˆå°±æ˜¯ â€œelkanâ€ï¼Œå¦åˆ™å°±æ˜¯â€fullâ€ã€‚ä¸€èˆ¬æ¥è¯´å»ºè®®ç›´æ¥ç”¨é»˜è®¤çš„â€autoâ€</li>
<li>n_jobsï¼šè¡¨ç¤ºä»»åŠ¡ä½¿ç”¨CPUæ•°é‡</li>
<li>random_stateï¼šè¡¨ç¤ºéšæœºæ•°ç”Ÿæˆå™¨çš„ç§å­ã€‚</li>
<li>verboseï¼š0è¡¨ç¤ºä¸è¾“å‡ºæ—¥å¿—ä¿¡æ¯ï¼›1è¡¨ç¤ºæ¯éš”ä¸€æ®µæ—¶é—´æ‰“å°ä¸€æ¬¡æ—¥å¿—ä¿¡æ¯ã€‚å¦‚æœå¤§äº1ï¼Œæ‰“å°æ¬¡æ•°é¢‘ç¹ã€‚</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> sklearn.datasets.samples_generator <span class="hljs-keyword">import</span> make_blobs<br><br><span class="hljs-comment"># Xä¸ºæ ·æœ¬ç‰¹å¾ï¼ŒYä¸ºæ ·æœ¬ç°‡ç±»åˆ«ï¼Œ å…±1000ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬2ä¸ªç‰¹å¾ï¼Œå…±4ä¸ªç°‡ï¼Œç°‡ä¸­å¿ƒåœ¨[-1,-1], [0,0],[1,1], [2,2]ï¼Œ ç°‡æ–¹å·®åˆ†åˆ«ä¸º[0.4, 0.2, 0.2]</span><br>X, y = make_blobs(n_samples=<span class="hljs-number">1000</span>, n_features=<span class="hljs-number">2</span>, centers=[[-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>], [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>], [<span class="hljs-number">1</span>,<span class="hljs-number">1</span>], [<span class="hljs-number">2</span>,<span class="hljs-number">2</span>]], cluster_std=[<span class="hljs-number">0.4</span>, <span class="hljs-number">0.2</span>, <span class="hljs-number">0.2</span>, <span class="hljs-number">0.2</span>], <br>                  random_state =<span class="hljs-number">9</span>)<br>plt.scatter(X[:, <span class="hljs-number">0</span>], X[:, <span class="hljs-number">1</span>], marker=<span class="hljs-string">&#x27;o&#x27;</span>)<br>plt.show()<br><br><span class="hljs-comment"># è®­ç»ƒ &amp; é¢„æµ‹</span><br><span class="hljs-keyword">from</span> sklearn.cluster <span class="hljs-keyword">import</span> KMeans<br>km = KMeans(n_clusters=<span class="hljs-number">2</span>, random_state=<span class="hljs-number">9</span>, n_init=<span class="hljs-number">10</span>, max_iter=<span class="hljs-number">300</span>, init=<span class="hljs-string">&#x27;k-means++&#x27;</span>, verbose=<span class="hljs-number">1</span>)<br>y_pred = km.fit_predict(X)<br>plt.scatter(X[:, <span class="hljs-number">0</span>], X[:, <span class="hljs-number">1</span>], c=y_pred)<br>plt.show()<br><br><span class="hljs-comment"># è§‚å¯Ÿåœ¨ä¸åŒçš„kå€¼ä¸‹Calinski-Harabaszåˆ†æ•°ï¼Œåˆ†æ•°å€¼ğ‘ è¶Šå¤§åˆ™èšç±»æ•ˆæœè¶Šå¥½</span><br><span class="hljs-keyword">from</span> sklearn <span class="hljs-keyword">import</span> metrics<br>s = metrics.calinski_harabaz_score(X, y_pred)  <br></code></pre></td></tr></table></figure>
<h2 id="å¦‚ä½•åœ¨-Python-ä¸­ä»å¤´å¼€å§‹ç¼–å†™-K-meansï¼Ÿ"><a href="#å¦‚ä½•åœ¨-Python-ä¸­ä»å¤´å¼€å§‹ç¼–å†™-K-meansï¼Ÿ" class="headerlink" title="å¦‚ä½•åœ¨ Python ä¸­ä»å¤´å¼€å§‹ç¼–å†™ K-meansï¼Ÿ"></a>å¦‚ä½•åœ¨ Python ä¸­ä»å¤´å¼€å§‹ç¼–å†™ K-meansï¼Ÿ</h2><p>æˆ‘ä»¬çš„ k-means å®ç°å°†åˆ†ä¸ºäº”ä¸ªè¾…åŠ©æ–¹æ³•å’Œä¸€ä¸ªè¿è¡Œç®—æ³•çš„ä¸»å¾ªç¯ã€‚è®©æˆ‘ä»¬ä¸€ä¸€ä»‹ç»è¿™äº›åŠŸèƒ½ã€‚</p>
<ul>
<li>æˆå¯¹è·ç¦»</li>
<li>åˆå§‹åŒ–ä¸­å¿ƒ</li>
<li>æ›´æ–°åˆ†é…</li>
<li>æ›´æ–°ä¸­å¿ƒ</li>
<li>è®¡ç®—æŸå¤±</li>
<li>ä¸»å¾ªç¯</li>
<li>å®Œæ•´çš„å®ç°</li>
</ul>
<h3 id="è®¡ç®—æˆå¯¹è·ç¦»"><a href="#è®¡ç®—æˆå¯¹è·ç¦»" class="headerlink" title="è®¡ç®—æˆå¯¹è·ç¦»"></a><strong>è®¡ç®—æˆå¯¹è·ç¦»</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">pairwise_dist</span>(<span class="hljs-params">self, x, y</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        Args:</span><br><span class="hljs-string">            x: N x D numpy array</span><br><span class="hljs-string">            y: M x D numpy array</span><br><span class="hljs-string">        Return:</span><br><span class="hljs-string">            dist: N x M array, where dist2[i, j] is the euclidean distance between </span><br><span class="hljs-string">            x[i, :] and y[j, :]</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        xSumSquare = np.<span class="hljs-built_in">sum</span>(np.square(x),axis=<span class="hljs-number">1</span>);<br>        ySumSquare = np.<span class="hljs-built_in">sum</span>(np.square(y),axis=<span class="hljs-number">1</span>);<br>        mul = np.dot(x, y.T);<br>        dists = np.sqrt(<span class="hljs-built_in">abs</span>(xSumSquare[:, np.newaxis] + ySumSquare-<span class="hljs-number">2</span>*mul))<br>        <span class="hljs-keyword">return</span> dists<br></code></pre></td></tr></table></figure>
<p>pairwise_dist å‡½æ•°ä¸å‰é¢æè¿°çš„ç›¸ä¼¼æ€§å‡½æ•°ç­‰æ•ˆã€‚è¿™æ˜¯æˆ‘ä»¬æ¯”è¾ƒä¸¤ç‚¹ç›¸ä¼¼æ€§çš„æŒ‡æ ‡ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯<strong>æ¬§å‡ é‡Œå¾—è·ç¦»</strong>ã€‚æˆ‘ä½¿ç”¨çš„å…¬å¼å¯èƒ½çœ‹èµ·æ¥ä¸æ¬§å‡ é‡Œå¾·è·ç¦»å‡½æ•°çš„å¸¸è§„å…¬å¼ä¸åŒã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ­£åœ¨æ‰§è¡ŒçŸ©é˜µæ“ä½œï¼Œè€Œä¸æ˜¯ä½¿ç”¨ä¸¤ä¸ªå•ä¸ªå‘é‡ã€‚åœ¨<a target="_blank" rel="noopener" href="https://www.dabblingbadger.com/blog/2020/2/27/implementing-euclidean-distance-matrix-calculations-from-scratch-in-python">è¿™é‡Œ</a>æ·±å…¥é˜…è¯»ã€‚</p>
<h3 id="åˆå§‹åŒ–ä¸­å¿ƒ"><a href="#åˆå§‹åŒ–ä¸­å¿ƒ" class="headerlink" title="åˆå§‹åŒ–ä¸­å¿ƒ"></a><strong>åˆå§‹åŒ–ä¸­å¿ƒ</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_init_centers</span>(<span class="hljs-params">self, points, K, **kwargs</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        Args:</span><br><span class="hljs-string">            points: NxD numpy array, where N is # points and D is the dimensionality</span><br><span class="hljs-string">            K: number of clusters</span><br><span class="hljs-string">            kwargs: any additional arguments you want</span><br><span class="hljs-string">        Return:</span><br><span class="hljs-string">            centers: K x D numpy array, the centers. </span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        row, col = points.shape<br>        retArr = np.empty([K, col])<br>        <span class="hljs-keyword">for</span> number <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(K):<br>            randIndex = np.random.randint(row)<br>            retArr[number] = points[randIndex]<br>        <br>        <span class="hljs-keyword">return</span> retArr<br></code></pre></td></tr></table></figure>
<p>è¯¥å‡½æ•°æ¥æ”¶ç‚¹æ•°ç»„å¹¶éšæœºé€‰æ‹©å…¶ä¸­çš„ K ä¸ªä½œä¸ºåˆå§‹è´¨å¿ƒã€‚è¯¥å‡½æ•°ä»…è¿”å› K ä¸ªé€‰å®šç‚¹ã€‚</p>
<h3 id="æ›´æ–°åˆ†é…"><a href="#æ›´æ–°åˆ†é…" class="headerlink" title="æ›´æ–°åˆ†é…"></a><strong>æ›´æ–°åˆ†é…</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_update_assignment</span>(<span class="hljs-params">self, centers, points</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        Args:</span><br><span class="hljs-string">            centers: KxD numpy array, where K is the number of clusters, and D is the dimension</span><br><span class="hljs-string">            points: NxD numpy array, the observations</span><br><span class="hljs-string">        Return:</span><br><span class="hljs-string">            cluster_idx: numpy array of length N, the cluster assignment for each point</span><br><span class="hljs-string"></span><br><span class="hljs-string">        Hint: You could call pairwise_dist() function.</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        row, col = points.shape<br>        cluster_idx = np.empty([row])<br>        distances = self.pairwise_dist(points, centers)<br>        cluster_idx = np.argmin(distances, axis=<span class="hljs-number">1</span>)<br><br>        <span class="hljs-keyword">return</span> cluster_idx<br></code></pre></td></tr></table></figure>
<p>æ›´æ–°åˆ†é…å‡½æ•°è´Ÿè´£é€‰æ‹©æ¯ä¸ªç‚¹åº”è¯¥å±äºå“ªä¸ªé›†ç¾¤ã€‚é¦–å…ˆï¼Œæˆ‘ä½¿ç”¨ pairwise_dist å‡½æ•°è®¡ç®—æ¯ä¸ªç‚¹å’Œæ¯ä¸ªè´¨å¿ƒä¹‹é—´çš„è·ç¦»ã€‚ç„¶åï¼Œæˆ‘å¾—åˆ°æ¯ä¸€è¡Œçš„æœ€å°è·ç¦»çš„ç´¢å¼•ã€‚æœ€å°è·ç¦»çš„ç´¢å¼•ä¹Ÿæ˜¯ç»™å®šæ•°æ®ç‚¹çš„èšç±»åˆ†é…ç´¢å¼•ï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›å°†æ¯ä¸ªç‚¹åˆ†é…ç»™æœ€è¿‘çš„è´¨å¿ƒã€‚</p>
<h3 id="æ›´æ–°ä¸­å¿ƒ"><a href="#æ›´æ–°ä¸­å¿ƒ" class="headerlink" title="æ›´æ–°ä¸­å¿ƒ"></a><strong>æ›´æ–°ä¸­å¿ƒ</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_update_centers</span>(<span class="hljs-params">self, old_centers, cluster_idx, points</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        Args:</span><br><span class="hljs-string">            old_centers: old centers KxD numpy array, where K is the number of clusters, and D is the dimension</span><br><span class="hljs-string">            cluster_idx: numpy array of length N, the cluster assignment for each point</span><br><span class="hljs-string">            points: NxD numpy array, the observations</span><br><span class="hljs-string">        Return:</span><br><span class="hljs-string">            centers: new centers, K x D numpy array, where K is the number of clusters, and D is the dimension.</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        K, D = old_centers.shape<br>        new_centers = np.empty(old_centers.shape)<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(K):<br>            new_centers[i] = np.mean(points[cluster_idx == i], axis = <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">return</span> new_centers<br></code></pre></td></tr></table></figure>
<p>æ›´æ–°ä¸­å¿ƒåŠŸèƒ½è´Ÿè´£å¯¹å±äºç»™å®šé›†ç¾¤çš„æ‰€æœ‰ç‚¹è¿›è¡Œå¹³å‡ã€‚è¯¥å¹³å‡å€¼æ˜¯ç›¸åº”èšç±»çš„æ–°è´¨å¿ƒã€‚è¯¥å‡½æ•°è¿”å›æ–°ä¸­å¿ƒçš„æ•°ç»„ã€‚</p>
<h3 id="è®¡ç®—æŸå¤±"><a href="#è®¡ç®—æŸå¤±" class="headerlink" title="è®¡ç®—æŸå¤±"></a><strong>è®¡ç®—æŸå¤±</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">_get_loss</span>(<span class="hljs-params">self, centers, cluster_idx, points</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        Args:</span><br><span class="hljs-string">            centers: KxD numpy array, where K is the number of clusters, and D is the dimension</span><br><span class="hljs-string">            cluster_idx: numpy array of length N, the cluster assignment for each point</span><br><span class="hljs-string">            points: NxD numpy array, the observations</span><br><span class="hljs-string">        Return:</span><br><span class="hljs-string">            loss: a single float number, which is the objective function of KMeans. </span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        dists = self.pairwise_dist(points, centers)<br>        loss = <span class="hljs-number">0.0</span><br>        N, D = points.shape<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(N):<br>            loss = loss + np.square(dists[i][cluster_idx[i]])<br>        <br>        <span class="hljs-keyword">return</span> loss<br></code></pre></td></tr></table></figure>
<p>æŸå¤±å‡½æ•°æ˜¯æˆ‘ä»¬è¯„ä¼°èšç±»ç®—æ³•æ€§èƒ½çš„æŒ‡æ ‡ã€‚æˆ‘ä»¬çš„æŸå¤±åªæ˜¯æ¯ä¸ªç‚¹ä¸å…¶èšç±»è´¨å¿ƒä¹‹é—´çš„å¹³æ–¹è·ç¦»ä¹‹å’Œã€‚åœ¨æˆ‘ä»¬çš„å®ç°ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆè°ƒç”¨æˆå¯¹è·ç¦»æ¥è·å¾—æ¯ä¸ªç‚¹å’Œæ¯ä¸ªä¸­å¿ƒä¹‹é—´çš„è·ç¦»çŸ©é˜µã€‚æˆ‘ä»¬ä½¿ç”¨ cluster_idx ä¸ºæ¯ä¸ªç‚¹é€‰æ‹©ä¸é›†ç¾¤å¯¹åº”çš„é€‚å½“è·ç¦»2ã€‚</p>
<h3 id="ä¸»å¾ªç¯"><a href="#ä¸»å¾ªç¯" class="headerlink" title="ä¸»å¾ªç¯"></a><strong>ä¸»å¾ªç¯</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">__call__</span>(<span class="hljs-params">self, points, K, max_iters=<span class="hljs-number">100</span>, abs_tol=<span class="hljs-number">1e-16</span>, rel_tol=<span class="hljs-number">1e-16</span>, verbose=<span class="hljs-literal">False</span>, **kwargs</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        Args:</span><br><span class="hljs-string">            points: NxD numpy array, where N is # points and D is the dimensionality</span><br><span class="hljs-string">            K: number of clusters</span><br><span class="hljs-string">            max_iters: maximum number of iterations (Hint: You could change it when debugging)</span><br><span class="hljs-string">            abs_tol: convergence criteria w.r.t absolute change of loss</span><br><span class="hljs-string">            rel_tol: convergence criteria w.r.t relative change of loss</span><br><span class="hljs-string">            verbose: boolean to set whether method should print loss (Hint: helpful for debugging)</span><br><span class="hljs-string">            kwargs: any additional arguments you want</span><br><span class="hljs-string">        Return:</span><br><span class="hljs-string">            cluster assignments: Nx1 int numpy array</span><br><span class="hljs-string">            cluster centers: K x D numpy array, the centers</span><br><span class="hljs-string">            loss: final loss value of the objective function of KMeans</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        centers = self._init_centers(points, K, **kwargs)<br>        <span class="hljs-keyword">for</span> it <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(max_iters):<br>            cluster_idx = self._update_assignment(centers, points)<br>            centers = self._update_centers(centers, cluster_idx, points)<br>            loss = self._get_loss(centers, cluster_idx, points)<br>            K = centers.shape[<span class="hljs-number">0</span>]<br>            <span class="hljs-keyword">if</span> it:<br>                diff = np.<span class="hljs-built_in">abs</span>(prev_loss - loss)<br>                <span class="hljs-keyword">if</span> diff &lt; abs_tol <span class="hljs-keyword">and</span> diff / prev_loss &lt; rel_tol:<br>                    <span class="hljs-keyword">break</span><br>            prev_loss = loss<br>            <span class="hljs-keyword">if</span> verbose:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;iter %d, loss: %.4f&#x27;</span> % (it, loss))<br>        <span class="hljs-keyword">return</span> cluster_idx, centers, loss<br></code></pre></td></tr></table></figure>
<p>ç°åœ¨ï¼Œåœ¨ä¸»å¾ªç¯ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç»„åˆæ‰€æœ‰å®ç”¨å‡½æ•°å¹¶å®ç°ä¼ªä»£ç ã€‚é¦–å…ˆï¼Œä¸­å¿ƒç”¨<strong>_init_centers</strong>éšæœºåˆå§‹åŒ–ã€‚ç„¶åï¼Œå¯¹äºæŒ‡å®šçš„è¿­ä»£æ¬¡æ•°ï¼Œæˆ‘ä»¬é‡å¤<strong>update_assignment</strong>å’Œ<strong>update_centers</strong>æ­¥éª¤ã€‚æ¯æ¬¡è¿­ä»£åï¼Œæˆ‘ä»¬è®¡ç®—æ€»æŸå¤±å¹¶å°†å…¶ä¸ä¹‹å‰çš„æŸå¤±è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœå·®å¼‚å°äºæˆ‘ä»¬çš„é˜ˆå€¼ï¼Œåˆ™ç®—æ³•æ‰§è¡Œå®Œæˆã€‚</p>
<h3 id="å®Œæ•´çš„-K-Means-ç±»å®ç°"><a href="#å®Œæ•´çš„-K-Means-ç±»å®ç°" class="headerlink" title="å®Œæ•´çš„ K-Means ç±»å®ç°"></a><strong>å®Œæ•´çš„ K-Means ç±»å®ç°</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> absolute_import<br><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> print_function<br><span class="hljs-keyword">from</span> __future__ <span class="hljs-keyword">import</span> division<br><br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> matplotlib<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> mpl_toolkits.mplot3d <span class="hljs-keyword">import</span> axes3d<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br><span class="hljs-comment"># Load image</span><br><span class="hljs-keyword">import</span> imageio<br><br><br><span class="hljs-comment"># Set random seed so output is all same</span><br>np.random.seed(<span class="hljs-number">1</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">KMeans</span>(<span class="hljs-title class_ inherited__">object</span>):<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):  <span class="hljs-comment"># No need to implement</span><br>        <span class="hljs-keyword">pass</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">pairwise_dist</span>(<span class="hljs-params">self, x, y</span>):  <span class="hljs-comment"># [5 pts]</span><br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        Args:</span><br><span class="hljs-string">            x: N x D numpy array</span><br><span class="hljs-string">            y: M x D numpy array</span><br><span class="hljs-string">        Return:</span><br><span class="hljs-string">                dist: N x M array, where dist2[i, j] is the euclidean distance between </span><br><span class="hljs-string">                x[i, :] and y[j, :]</span><br><span class="hljs-string">                &quot;&quot;&quot;</span><br>        xSumSquare = np.<span class="hljs-built_in">sum</span>(np.square(x),axis=<span class="hljs-number">1</span>);<br>        ySumSquare = np.<span class="hljs-built_in">sum</span>(np.square(y),axis=<span class="hljs-number">1</span>);<br>        mul = np.dot(x, y.T);<br>        dists = np.sqrt(<span class="hljs-built_in">abs</span>(xSumSquare[:, np.newaxis] + ySumSquare-<span class="hljs-number">2</span>*mul))<br>        <span class="hljs-keyword">return</span> dists<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_init_centers</span>(<span class="hljs-params">self, points, K, **kwargs</span>):  <span class="hljs-comment"># [5 pts]</span><br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        Args:</span><br><span class="hljs-string">            points: NxD numpy array, where N is # points and D is the dimensionality</span><br><span class="hljs-string">            K: number of clusters</span><br><span class="hljs-string">            kwargs: any additional arguments you want</span><br><span class="hljs-string">        Return:</span><br><span class="hljs-string">            centers: K x D numpy array, the centers. </span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        row, col = points.shape<br>        retArr = np.empty([K, col])<br>        <span class="hljs-keyword">for</span> number <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(K):<br>            randIndex = np.random.randint(row)<br>            retArr[number] = points[randIndex]<br>        <br>        <span class="hljs-keyword">return</span> retArr<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_update_assignment</span>(<span class="hljs-params">self, centers, points</span>):  <span class="hljs-comment"># [10 pts]</span><br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        Args:</span><br><span class="hljs-string">            centers: KxD numpy array, where K is the number of clusters, and D is the dimension</span><br><span class="hljs-string">            points: NxD numpy array, the observations</span><br><span class="hljs-string">        Return:</span><br><span class="hljs-string">            cluster_idx: numpy array of length N, the cluster assignment for each point</span><br><span class="hljs-string"></span><br><span class="hljs-string">        Hint: You could call pairwise_dist() function.</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        row, col = points.shape<br>        cluster_idx = np.empty([row])<br>        distances = self.pairwise_dist(points, centers)<br>        cluster_idx = np.argmin(distances, axis=<span class="hljs-number">1</span>)<br><br>        <span class="hljs-keyword">return</span> cluster_idx<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_update_centers</span>(<span class="hljs-params">self, old_centers, cluster_idx, points</span>):  <span class="hljs-comment"># [10 pts]</span><br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        Args:</span><br><span class="hljs-string">            old_centers: old centers KxD numpy array, where K is the number of clusters, and D is the dimension</span><br><span class="hljs-string">            cluster_idx: numpy array of length N, the cluster assignment for each point</span><br><span class="hljs-string">            points: NxD numpy array, the observations</span><br><span class="hljs-string">        Return:</span><br><span class="hljs-string">            centers: new centers, K x D numpy array, where K is the number of clusters, and D is the dimension.</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        K, D = old_centers.shape<br>        new_centers = np.empty(old_centers.shape)<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(K):<br>            new_centers[i] = np.mean(points[cluster_idx == i], axis = <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">return</span> new_centers<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_get_loss</span>(<span class="hljs-params">self, centers, cluster_idx, points</span>):  <span class="hljs-comment"># [5 pts]</span><br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        Args:</span><br><span class="hljs-string">            centers: KxD numpy array, where K is the number of clusters, and D is the dimension</span><br><span class="hljs-string">            cluster_idx: numpy array of length N, the cluster assignment for each point</span><br><span class="hljs-string">            points: NxD numpy array, the observations</span><br><span class="hljs-string">        Return:</span><br><span class="hljs-string">            loss: a single float number, which is the objective function of KMeans. </span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        dists = self.pairwise_dist(points, centers)<br>        loss = <span class="hljs-number">0.0</span><br>        N, D = points.shape<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(N):<br>            loss = loss + np.square(dists[i][cluster_idx[i]])<br>        <br>        <span class="hljs-keyword">return</span> loss<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__call__</span>(<span class="hljs-params">self, points, K, max_iters=<span class="hljs-number">100</span>, abs_tol=<span class="hljs-number">1e-16</span>, rel_tol=<span class="hljs-number">1e-16</span>, verbose=<span class="hljs-literal">False</span>, **kwargs</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        Args:</span><br><span class="hljs-string">            points: NxD numpy array, where N is # points and D is the dimensionality</span><br><span class="hljs-string">            K: number of clusters</span><br><span class="hljs-string">            max_iters: maximum number of iterations (Hint: You could change it when debugging)</span><br><span class="hljs-string">            abs_tol: convergence criteria w.r.t absolute change of loss</span><br><span class="hljs-string">            rel_tol: convergence criteria w.r.t relative change of loss</span><br><span class="hljs-string">            verbose: boolean to set whether method should print loss (Hint: helpful for debugging)</span><br><span class="hljs-string">            kwargs: any additional arguments you want</span><br><span class="hljs-string">        Return:</span><br><span class="hljs-string">            cluster assignments: Nx1 int numpy array</span><br><span class="hljs-string">            cluster centers: K x D numpy array, the centers</span><br><span class="hljs-string">            loss: final loss value of the objective function of KMeans</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        centers = self._init_centers(points, K, **kwargs)<br>        <span class="hljs-keyword">for</span> it <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(max_iters):<br>            cluster_idx = self._update_assignment(centers, points)<br>            centers = self._update_centers(centers, cluster_idx, points)<br>            loss = self._get_loss(centers, cluster_idx, points)<br>            K = centers.shape[<span class="hljs-number">0</span>]<br>            <span class="hljs-keyword">if</span> it:<br>                diff = np.<span class="hljs-built_in">abs</span>(prev_loss - loss)<br>                <span class="hljs-keyword">if</span> diff &lt; abs_tol <span class="hljs-keyword">and</span> diff / prev_loss &lt; rel_tol:<br>                    <span class="hljs-keyword">break</span><br>            prev_loss = loss<br>            <span class="hljs-keyword">if</span> verbose:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;iter %d, loss: %.4f&#x27;</span> % (it, loss))<br>        <span class="hljs-keyword">return</span> cluster_idx, centers, loss<br></code></pre></td></tr></table></figure>
<p>è¿™æ˜¯æˆ‘ä»¬åœ¨ Python ä¸­å®Œæ•´çš„ K-means ç±»å®ç°ã€‚æˆ‘é¼“åŠ±æ‚¨å¤åˆ¶æ­¤ä»£ç ï¼ˆæˆ–è‡ªå·±å®ç°ï¼ï¼‰å¹¶åœ¨æ‚¨è‡ªå·±çš„æœºå™¨ä¸Šè¿è¡Œå®ƒã€‚è¿™æ˜¯å·©å›ºæ‚¨å¯¹ K-means ç®—æ³•ç†è§£çš„æœ€ä½³æ–¹å¼ã€‚<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1010876">scikit-learnä¸­çš„KMeansèšç±»å®ç°</a></p>
<h2 id="åˆå§‹ä¸­å¿ƒç‚¹æ€ä¹ˆç¡®å®š"><a href="#åˆå§‹ä¸­å¿ƒç‚¹æ€ä¹ˆç¡®å®š" class="headerlink" title="åˆå§‹ä¸­å¿ƒç‚¹æ€ä¹ˆç¡®å®š"></a>åˆå§‹ä¸­å¿ƒç‚¹æ€ä¹ˆç¡®å®š</h2><p>åœ¨k-meansç®—æ³•æ­¥éª¤ä¸­ï¼Œæœ‰ä¸¤ä¸ªåœ°æ–¹é™ä½äº†SSEï¼š</p>
<ol>
<li>æŠŠæ ·æœ¬ç‚¹åˆ†åˆ°æœ€è¿‘é‚»çš„ç°‡ä¸­ï¼Œè¿™æ ·ä¼šé™ä½SSEçš„å€¼ï¼›</li>
<li>é‡æ–°ä¼˜åŒ–èšç±»ä¸­å¿ƒç‚¹ï¼Œè¿›ä¸€æ­¥çš„å‡å°äº†SSEã€‚</li>
</ol>
<p>è¿™æ ·çš„é‡å¤è¿­ä»£ã€ä¸æ–­ä¼˜åŒ–ï¼Œä¼šæ‰¾åˆ°<code>å±€éƒ¨æœ€ä¼˜è§£ï¼ˆå±€éƒ¨æœ€å°çš„SSEï¼‰</code>ï¼Œå¦‚æœæƒ³è¦æ‰¾åˆ°å…¨å±€æœ€ä¼˜è§£éœ€è¦æ‰¾åˆ°åˆç†çš„åˆå§‹èšç±»ä¸­å¿ƒã€‚</p>
<p><strong>é‚£åˆç†çš„åˆå§‹ä¸­å¿ƒæ€ä¹ˆé€‰ï¼Ÿ</strong></p>
<p>æ–¹æ³•æœ‰å¾ˆå¤šï¼Œè­¬å¦‚å…ˆéšä¾¿é€‰ä¸ªç‚¹ä½œä¸ºç¬¬1ä¸ªåˆå§‹ä¸­å¿ƒC1ï¼Œæ¥ä¸‹æ¥è®¡ç®—æ‰€æœ‰æ ·æœ¬ç‚¹ä¸C1çš„è·ç¦»ï¼Œè·ç¦»æœ€å¤§çš„è¢«é€‰ä¸ºä¸‹ä¸€ä¸ªä¸­å¿ƒC2ï¼Œç›´åˆ°é€‰å®ŒKä¸ªä¸­å¿ƒã€‚è¿™ä¸ªç®—æ³•å«åš<code>K-Means++</code>ï¼Œå¯ä»¥ç†è§£ä¸º K-Meansçš„æ”¹è¿›ç‰ˆï¼Œå®ƒå¯ä»¥èƒ½æœ‰æ•ˆåœ°è§£å†³åˆå§‹ä¸­å¿ƒçš„é€‰å–é—®é¢˜ï¼Œä½†<code>æ— æ³•è§£å†³ç¦»ç¾¤ç‚¹é—®é¢˜</code>ã€‚</p>
<h2 id="Kå€¼æ€ä¹ˆç¡®å®š"><a href="#Kå€¼æ€ä¹ˆç¡®å®š" class="headerlink" title="Kå€¼æ€ä¹ˆç¡®å®š"></a>Kå€¼æ€ä¹ˆç¡®å®š</h2><p>ä½¿ç”¨ K å‡å€¼ç®—æ³•ï¼Œæ€§èƒ½å¯èƒ½ä¼šå› æ‚¨ä½¿ç”¨çš„é›†ç¾¤æ•°é‡è€Œæœ‰å¾ˆå¤§å·®å¼‚ã€‚è¦çŸ¥é“ï¼Œ<strong>Kè®¾ç½®å¾—è¶Šå¤§ï¼Œæ ·æœ¬åˆ’åˆ†å¾—å°±è¶Šç»†ï¼Œæ¯ä¸ªç°‡çš„èšåˆç¨‹åº¦å°±è¶Šé«˜ï¼Œè¯¯å·®å¹³æ–¹å’ŒSSEè‡ªç„¶å°±è¶Šå°</strong>ã€‚æ‰€ä»¥ä¸èƒ½å•çº¯åƒé€‰æ‹©åˆå§‹ç‚¹é‚£æ ·ï¼Œç”¨ä¸åŒçš„Kæ¥åšå°è¯•ï¼Œé€‰æ‹©SSEæœ€å°çš„èšç±»ç»“æœå¯¹åº”çš„Kå€¼ï¼Œå› ä¸ºè¿™æ ·é€‰å‡ºæ¥çš„è‚¯å®šæ˜¯ä½ å°è¯•çš„é‚£äº›Kå€¼ä¸­æœ€å¤§çš„é‚£ä¸ªã€‚</p>
<h3 id="â€œæ‰‹è‚˜æ³•â€ï¼ˆElbow-Methodï¼‰"><a href="#â€œæ‰‹è‚˜æ³•â€ï¼ˆElbow-Methodï¼‰" class="headerlink" title="â€œæ‰‹è‚˜æ³•â€ï¼ˆElbow Methodï¼‰"></a>â€œæ‰‹è‚˜æ³•â€ï¼ˆElbow Methodï¼‰</h3><p>ä¸ºäº†ä½¿ç”¨è‚˜éƒ¨æ–¹æ³•ï¼Œæ‚¨åªéœ€å¤šæ¬¡è¿è¡Œ K-means ç®—æ³•ï¼Œæ¯æ¬¡è¿­ä»£å°†èšç±»æ•°å¢åŠ ä¸€ä¸ªã€‚è®°å½•æ¯æ¬¡è¿­ä»£çš„æŸå¤±ï¼Œç„¶å<strong>åˆ¶ä½œ num cluster vs loss çš„æŠ˜çº¿å›¾</strong>ã€‚</p>
<p>ä¸‹é¢æ˜¯è‚˜éƒ¨æ–¹æ³•çš„ç®€å•å®ç°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sklearn <span class="hljs-keyword">import</span> metrics<br>metrics.calinski_harabaz_score(X, y_pred) <br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sklearn.cluster <span class="hljs-keyword">import</span> KMeans<br><br>loss = []<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>):<br>    kmeans = KMeans(n_clusters=i, max_iter=<span class="hljs-number">100</span>).fit(p_list)<br>    loss.append(kmeans.inertia_ / point_number / K)<br>    <br>plt.plot(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>), loss)<br>plt.show()<br></code></pre></td></tr></table></figure>
<p>è¿è¡Œæ­¤æ–¹æ³•å°†è¾“å‡ºä¸€ä¸ªç±»ä¼¼äºæ‚¨åœ¨ä¸‹é¢çœ‹åˆ°çš„å›¾ï¼š</p>
<p><img src="https://i1.wp.com/analyticsarora.com/wp-content/uploads/2021/07/elbow-method-example-choosing-number-of-clusters-k-means.png?resize=464%2C299&amp;ssl=1#id=JyGLl&amp;originHeight=299&amp;originWidth=464&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" srcset="/img/loading.gif" lazyload alt=""></p>
<p>ç°åœ¨ï¼Œä¸ºäº†é€‰æ‹©æ­£ç¡®æ•°é‡çš„ç°‡ï¼Œæˆ‘ä»¬è¿›è¡Œç›®è§†æ£€æŸ¥ã€‚æŸè€—æ›²çº¿å¼€å§‹å¼¯æ›²çš„<strong>ç‚¹</strong>ç§°ä¸º <strong>è‚˜ç‚¹</strong>ã€‚è‚˜ç‚¹ä»£è¡¨è¯¯å·®å’Œèšç±»æ•°é‡ä¹‹é—´çš„åˆç†æƒè¡¡ã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œè‚˜ç‚¹ä½äº<strong>x = 3 å¤„</strong>ã€‚è¿™æ„å‘³ç€æœ€ä½³èšç±»æ•°ä¸º 3ã€‚</p>
<h3 id="è½®å»“ç³»æ•°"><a href="#è½®å»“ç³»æ•°" class="headerlink" title="è½®å»“ç³»æ•°"></a>è½®å»“ç³»æ•°</h3><p>æ•°æ®çš„å¹³å‡è½®å»“æ˜¯è¯„ä¼°é›†ç¾¤è‡ªç„¶æ•°çš„å¦ä¸€ä¸ªæœ‰ç”¨æ ‡å‡†ã€‚æ•°æ®å®ä¾‹çš„è½®å»“æ˜¯è¡¡é‡å®ƒä¸é›†ç¾¤å†…æ•°æ®åŒ¹é…ç¨‹åº¦ä»¥åŠä¸ç›¸é‚»é›†ç¾¤æ•°æ®åŒ¹é…ç¨‹åº¦çš„åº¦é‡ã€‚</p>
<p>è½®å»“å€¼æ˜¯è¡¡é‡ä¸€ä¸ªå¯¹è±¡ä¸å…¶è‡ªå·±çš„é›†ç¾¤ï¼ˆå†…èšï¼‰ç›¸æ¯”å…¶ä»–é›†ç¾¤ï¼ˆåˆ†ç¦»ï¼‰çš„ç›¸ä¼¼ç¨‹åº¦ã€‚è½®å»“èŒƒå›´ä» -1 åˆ° +1ï¼Œå…¶ä¸­é«˜å€¼è¡¨ç¤ºå¯¹è±¡ä¸å…¶è‡ªå·±çš„é›†ç¾¤åŒ¹é…è‰¯å¥½ï¼Œè€Œä¸ç›¸é‚»é›†ç¾¤åŒ¹é…ä¸ä½³ã€‚å¦‚æœå¤§å¤šæ•°å¯¹è±¡å…·æœ‰è¾ƒé«˜çš„å€¼ï¼Œåˆ™é›†ç¾¤é…ç½®æ˜¯åˆé€‚çš„ã€‚å¦‚æœè®¸å¤šç‚¹å…·æœ‰ä½å€¼æˆ–è´Ÿå€¼ï¼Œåˆ™èšç±»é…ç½®å¯èƒ½å…·æœ‰è¿‡å¤šæˆ–è¿‡å°‘çš„èšç±»ã€‚</p>
<p>å¦‚æœæ‚¨æƒ³å®ç°ç”¨äºèšç±»åˆ†æçš„è½®å»“ç³»æ•°ï¼Œæˆ‘å»ºè®®ä½¿ç”¨ scikit-learnã€‚è®¿é—®<a target="_blank" rel="noopener" href="https://scikit-learn.org/stable/auto_examples/cluster/plot_kmeans_silhouette_analysis.html">æ­¤</a>èµ„æºä»¥è·å–æœ‰å…³å®æ–½çš„å®Œæ•´æŒ‡å—ã€‚</p>
<h2 id="æ­£ç¡®ä½¿ç”¨ã€ŒKå‡å€¼èšç±»ã€çš„Tips"><a href="#æ­£ç¡®ä½¿ç”¨ã€ŒKå‡å€¼èšç±»ã€çš„Tips" class="headerlink" title="æ­£ç¡®ä½¿ç”¨ã€ŒKå‡å€¼èšç±»ã€çš„Tips"></a>æ­£ç¡®ä½¿ç”¨ã€ŒKå‡å€¼èšç±»ã€çš„Tips</h2><ol>
<li><strong>è¾“å…¥æ•°æ®ä¸€èˆ¬éœ€è¦åšç¼©æ”¾</strong>ï¼Œå¦‚æ ‡å‡†åŒ–ã€‚åŸå› å¾ˆç®€å•ï¼ŒKå‡å€¼æ˜¯å»ºç«‹åœ¨è·ç¦»åº¦é‡ä¸Šçš„ï¼Œå› æ­¤ä¸åŒå˜é‡é—´å¦‚æœç»´åº¦å·®åˆ«è¿‡å¤§ï¼Œå¯èƒ½ä¼šé€ æˆå°‘æ•°å˜é‡â€œæ–½åŠ äº†è¿‡é«˜çš„å½±å“è€Œé€ æˆå„æ–­â€ã€‚</li>
<li><strong>è¾“å‡ºç»“æœéå›ºå®šï¼Œå¤šæ¬¡è¿è¡Œç»“æœå¯èƒ½ä¸åŒã€‚</strong>é¦–å…ˆè¦æ„è¯†åˆ°K-meansä¸­æ˜¯æœ‰éšæœºæ€§çš„ï¼Œä»åˆå§‹åŒ–åˆ°æ”¶æ•›ç»“æœå¾€å¾€ä¸åŒã€‚ä¸€ç§çœ‹æ³•æ˜¯å¼ºè¡Œå›ºå®šéšæœºæ€§ï¼Œæ¯”å¦‚è®¾å®šsklearnä¸­çš„random stateä¸ºå›ºå®šå€¼ã€‚å¦ä¸€ç§çœ‹æ³•æ˜¯ï¼Œå¦‚æœä½ çš„Kå‡å€¼ç»“æœæ€»åœ¨å¤§å¹…åº¦å˜åŒ–ï¼Œæ¯”å¦‚ä¸åŒç°‡ä¸­çš„æ•°æ®é‡åœ¨å¤šæ¬¡è¿è¡Œä¸­å˜åŒ–å¾ˆå¤§ï¼Œé‚£ä¹ˆKå‡å€¼ä¸é€‚åˆä½ çš„æ•°æ®ï¼Œä¸è¦è¯•å›¾ç¨³å®šç»“æœ [2]ã€‚</li>
<li><strong>è¿è¡Œæ—¶é—´å¾€å¾€å¯ä»¥å¾—åˆ°ä¼˜åŒ–ï¼Œé€‰æ‹©æœ€ä¼˜çš„å·¥å…·åº“ã€‚</strong>åŸºæœ¬ä¸Šç°åœ¨çš„Kå‡å€¼å®ç°éƒ½æ˜¯K-means++ï¼Œé€Ÿåº¦éƒ½ä¸é”™ã€‚ä½†å½“æ•°æ®é‡è¿‡å¤§æ—¶ï¼Œä¾ç„¶å¯ä»¥ä½¿ç”¨å…¶ä»–æ–¹æ³•ï¼Œå¦‚MiniBatchKMeans [3]ã€‚ä¸Šç™¾ä¸‡ä¸ªæ•°æ®ç‚¹å¾€å¾€å¯ä»¥åœ¨æ•°ç§’é’Ÿå†…å®Œæˆèšç±»ï¼Œæ¨èSklearnçš„å®ç°ã€‚</li>
<li><strong>é«˜ç»´æ•°æ®ä¸Šçš„æœ‰æ•ˆæ€§æœ‰é™ã€‚</strong>å»ºç«‹åœ¨è·ç¦»åº¦é‡ä¸Šçš„ç®—æ³•ä¸€èˆ¬éƒ½æœ‰ç±»ä¼¼çš„é—®é¢˜ï¼Œé‚£å°±æ˜¯åœ¨é«˜ç»´ç©ºé—´ä¸­è·ç¦»çš„æ„ä¹‰æœ‰äº†å˜åŒ–ï¼Œä¸”å¹¶éæ‰€æœ‰ç»´åº¦éƒ½æœ‰æ„ä¹‰ã€‚è¿™ç§æƒ…å†µä¸‹ï¼ŒKå‡å€¼çš„ç»“æœå¾€å¾€ä¸å¥½ï¼Œè€Œé€šè¿‡åˆ’åˆ†å­ç©ºé—´çš„ç®—æ³•ï¼ˆsub-spacing methodï¼‰æ•ˆæœå¯èƒ½æ›´å¥½ã€‚</li>
<li><strong>è¿è¡Œæ•ˆç‡ä¸æ€§èƒ½ä¹‹é—´çš„å–èˆã€‚</strong></li>
</ol>
<h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>å› æ­¤ä¸éš¾çœ‹å‡ºï¼ŒK-Meansä¼˜ç‚¹åœ¨äºåŸç†ç®€å•ï¼Œè¿è¡Œé€Ÿåº¦å¿«ä¸”å®¹æ˜“å®ç°ï¼Œèƒ½å¤Ÿå¤„ç†çš„æ•°æ®é‡å¤§ã€‚</p>
<p>å½“ç„¶ï¼Œä¹Ÿæœ‰ä¸€äº›ç¼ºç‚¹ï¼š</p>
<ul>
<li>åœ¨é«˜ç»´ä¸Šå¯èƒ½ä¸æ˜¯æœ€ä½³é€‰é¡¹</li>
<li>Kå€¼ã€åˆå§‹ç‚¹çš„é€‰å–ä¸å¥½ç¡®å®šï¼›</li>
<li>å¾—åˆ°çš„ç»“æœåªæ˜¯å±€éƒ¨æœ€ä¼˜ï¼›</li>
<li>å—ç¦»ç¾¤å€¼å½±å“å¤§ã€‚</li>
</ul>
<p>ä¸€ä¸ªæ¯”è¾ƒç²—æµ…çš„ç»“è®ºæ˜¯ï¼Œåœ¨æ•°æ®é‡ä¸å¤§æ—¶ï¼Œå¯ä»¥ä¼˜å…ˆå°è¯•å…¶ä»–ç®—æ³•ã€‚å½“æ•°æ®é‡è¿‡å¤§æ—¶ï¼Œå¯ä»¥è¯•è¯•HDBSCANã€‚ä»…å½“æ•°æ®é‡å·¨å¤§ï¼Œä¸”æ— æ³•é™ç»´æˆ–è€…é™ä½æ•°é‡æ—¶ï¼Œå†å°è¯•ä½¿ç”¨Kå‡å€¼ã€‚</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/75477709">ç”¨äººè¯è®²æ˜ç™½å¿«é€Ÿèšç±»kmeans</a> </li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/35959301">ä»é›¶å¼€å§‹æ•™ä½  KMeans ç®—æ³•</a> </li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/34330242">å¦‚ä½•æ­£ç¡®ä½¿ç”¨ã€ŒKå‡å€¼èšç±»ã€ï¼Ÿ</a> </li>
<li><a target="_blank" rel="noopener" href="https://www.biaodianfu.com/k-means-choose-k.html">K-Meansç®—æ³•ä¹‹Kå€¼çš„é€‰æ‹©</a> </li>
<li><a target="_blank" rel="noopener" href="http://zhouchen.tech/2017/12/22/sklearn%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B%EF%BC%9A%E5%88%86%E7%B1%BB%E3%80%81%E8%81%9A%E7%B1%BB%E3%80%81%E5%9B%9E%E5%BD%92%E5%92%8C%E9%99%8D%E7%BB%B4/">sklearnå…¥é—¨æ•™ç¨‹ï¼šåˆ†ç±»ã€èšç±»ã€å›å½’å’Œé™ç»´</a> </li>
</ul>
<p><a target="_blank" rel="noopener" href="https://analyticsarora.com/k-means-for-beginners-how-to-build-from-scratch-in-python">K-means for Beginners: How to Build from Scratch in Python</a></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E6%96%87%E6%9C%AC%E8%81%9A%E7%B1%BB/">#æ–‡æœ¬èšç±»</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>K-meansèšç±»è¯¦è§£</div>
      <div>http://example.com/2021/09/06/2021-09-06-K-meansèšç±»è¯¦è§£/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>NSX</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2021å¹´9æœˆ6æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/09/06/2021-09-06-faiss%E5%AE%9E%E7%8E%B0%E7%9A%84%E9%AB%98%E6%95%88%20K-means%20%E8%81%9A%E7%B1%BB/" title="faisså®ç°çš„é«˜æ•ˆ K-means èšç±»">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">faisså®ç°çš„é«˜æ•ˆ K-means èšç±»</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/09/06/2021-09-06-%E6%96%87%E6%9C%AC%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/" title="æ–‡æœ¬èšç±»ç®—æ³•æ€»ç»“">
                        <span class="hidden-mobile">æ–‡æœ¬èšç±»ç®—æ³•æ€»ç»“</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ç›®å½•</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
